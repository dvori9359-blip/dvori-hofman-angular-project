<div class="main-container">
  <header class="teams-header">
    <h1>All Projects</h1>
    <div class="header-actions">
      <input 
        type="text" 
        class="search-input" 
        placeholder="Search projects..."
        [ngModel]="searchTerm()"
        (ngModelChange)="searchTerm.set($event)">
    </div>
  </header>

  <hr class="separator">

  <div class="teams-grid">
    @for (project of filteredProjects(); track (project._id || project.id)) {
      <div class="team-card" (click)="enterProject(project._id || project.id)">
        
        <div class="card-actions">
          <button class="manage-btn-icon" (click)="openManageTeamModal(project, $event)" title="Manage Team">ðŸ‘¥</button>
          <button class="delete-btn-x" (click)="onDeleteProject(project._id || project.id, $event)">âœ•</button>
        </div>

        <div class="card-content">
          <div class="card-icon">ðŸš€</div>
          <h3 class="project-name">{{ project.name }}</h3>
          <p class="team-id">ID: {{ project._id || project.id }}</p>
        </div>
        
        <button class="enter-btn">
          View Tasks
        </button>
      </div>
    } @empty {
      <div class="empty-state">
        <p>No projects found matching your search.</p>
      </div>
    }
  </div>
</div>

@if (showTeamModal) {
  <div class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Manage Team</h2>
        <button class="close-x" (click)="closeModal()">âœ•</button>
      </div>
      
      <div class="form-group">
        <label>Add New Member:</label>
        <div class="add-member-row">
          <select [(ngModel)]="selectedUserIdToAdd" class="modal-input">
            <option [ngValue]="null">Select a user...</option>
            @for (user of allUsersList(); track (user.id || user._id)) {
              <option [value]="user.id || user._id">{{ user.name }} ({{ user.email }})</option>
            }
          </select>
          <button class="save-btn" (click)="addMemberToProjectTeam()">Add</button>
        </div>
      </div>
      
      <div class="members-section">
        <h4>Current Team Members:</h4>
        <ul class="members-list">
          @for (member of currentTeamMembers(); track (member.id || member._id)) {
            <li>
              <span class="member-name">{{ member.name }}</span>
              <span class="member-email">{{ member.email }}</span>
            </li>
          } @empty {
            <li class="no-members">No members in this team yet.</li>
          }
        </ul>
      </div>

      @if (alertMessage()) {
        <p class="alert-text" [class.success]="alertMessage().includes('×‘×”×¦×œ×—×”')">
          {{ alertMessage() }}
        </p>
      }
    </div>
  </div>
}